{
  "version": 3,
  "sources": [
    "/home/travis/build/qooxdoo/qxl.mobileshowcase/source/class/qxl/mobileshowcase/page/Canvas.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "qxl",
    "mobileshowcase",
    "page",
    "Abstract",
    "construct",
    "setTitle",
    "__ratio",
    "core",
    "Environment",
    "get",
    "members",
    "__canvasLeft",
    "__canvasTop",
    "__canvas",
    "__lastPoint",
    "__canvasSize",
    "_initialize",
    "clearButton",
    "ui",
    "mobile",
    "navigationbar",
    "Button",
    "addListener",
    "__clearCanvas",
    "getRightContainer",
    "add",
    "canvasSize",
    "Math",
    "max",
    "bom",
    "Viewport",
    "getWidth",
    "getHeight",
    "min",
    "canvas",
    "embed",
    "Canvas",
    "_onTrackStart",
    "_onTrackEnd",
    "_onTrack",
    "Event",
    "preventDefault",
    "setWidth",
    "_to",
    "setHeight",
    "element",
    "Style",
    "set",
    "getContentElement",
    "getContent",
    "_drawExample",
    "_createScrollContainer",
    "container",
    "Composite",
    "value",
    "ctx",
    "getContext2d",
    "fillStyle",
    "font",
    "fillText",
    "strokeStyle",
    "beginPath",
    "arc",
    "PI",
    "moveTo",
    "stroke",
    "width",
    "clearRect",
    "fillRect",
    "fill",
    "evt",
    "Location",
    "getLeft",
    "getTop",
    "__draw",
    "stopPropagation",
    "lastPoint",
    "getPointerId",
    "pointerLeft",
    "getViewportLeft",
    "pointerTop",
    "getViewportTop",
    "opacity",
    "lineCap",
    "x",
    "y",
    "lineTo",
    "deltaX",
    "abs",
    "deltaY",
    "velocity",
    "sqrt",
    "pow",
    "round",
    "grad",
    "createLinearGradient",
    "addColorStop",
    "lineWidth",
    "destruct",
    "_disposeObjects"
  ],
  "mappings": "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",
  "sourcesContent": [
    "\n/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2014 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Christopher Zuendorf (czuendorf)\n\n************************************************************************ */\n\n/**\n * Mobile page showing a HTML5 canvas example.\n *\n * @asset(qx/mobile/css/*)\n */\nqx.Class.define(\"qxl.mobileshowcase.page.Canvas\",\n{\n  extend : qxl.mobileshowcase.page.Abstract,\n\n  construct : function()\n  {\n    this.base(arguments,false);\n    this.setTitle(\"Canvas\");\n    this.__ratio = qx.core.Environment.get(\"device.pixelRatio\");\n  },\n\n\n  members :\n  {\n    __canvasLeft : 0,\n    __canvasTop : 0,\n    __canvas : null,\n    __lastPoint : null,\n    __canvasSize : 1000,\n    __ratio : 1,\n\n\n    // overridden\n    _initialize : function()\n    {\n      this.base(arguments);\n\n      this.__lastPoint = {};\n\n      var clearButton = new qx.ui.mobile.navigationbar.Button(\"Clear\");\n      clearButton.addListener(\"tap\", this.__clearCanvas, this);\n\n      this.getRightContainer().add(clearButton);\n\n      var canvasSize = Math.max(qx.bom.Viewport.getWidth() * 1.5, qx.bom.Viewport.getHeight() * 1.5);\n\n      // Limit to maximum canvas size of iOS devices.\n      canvasSize = Math.min(canvasSize, 1448 / this.__ratio);\n\n      this.__canvasSize = canvasSize;\n\n      var canvas = this.__canvas = new qx.ui.mobile.embed.Canvas();\n\n      canvas.addListener(\"trackstart\", this._onTrackStart, this);\n      canvas.addListener(\"trackend\", this._onTrackEnd, this);\n      canvas.addListener(\"track\", this._onTrack, this);\n\n      canvas.addListener(\"touchstart\", qx.bom.Event.preventDefault, this);\n\n      canvas.setWidth(this._to(this.__canvasSize));\n      canvas.setHeight(this._to(this.__canvasSize));\n      qx.bom.element.Style.set(canvas.getContentElement(),\"width\", this.__canvasSize + \"px\");\n      qx.bom.element.Style.set(canvas.getContentElement(),\"height\", this.__canvasSize + \"px\");\n\n      this.getContent().add(canvas);\n\n      this.__clearCanvas();\n      this._drawExample();\n    },\n\n\n    _createScrollContainer : function() {\n      return new qx.ui.mobile.container.Composite();\n    },\n\n\n    /**\n    * Calculates the correct position in relation to the device pixel ratio.\n    * @return {Number} the correct position.\n    */\n    _to : function(value) {\n      return value * this.__ratio;\n    },\n\n\n    /**\n     * Draws the example on the canvas.\n     */\n    _drawExample : function() {\n      // Comment in Text\n      var ctx = this.__canvas.getContext2d();\n      ctx.fillStyle = 'gray';\n      ctx.font = 'bold '+this._to(16)+'px Helvetica';\n      ctx.fillText('Start drawing here ...', this._to(15), this._to(25));\n\n      // Smiley\n      ctx.strokeStyle = '#3D72C9';\n      ctx.beginPath();\n      ctx.arc(475, 85, 50, 0, Math.PI * 2, true);\n      ctx.moveTo(510, 85);\n      ctx.arc(475, 85, 35, 0, Math.PI, false);\n      ctx.moveTo(465, 75);\n      ctx.arc(460, 75, 5, 0, Math.PI * 2, true);\n      ctx.moveTo(495, 75);\n      ctx.arc(490, 75, 5, 0, Math.PI * 2, true);\n      ctx.stroke();\n    },\n\n\n    /**\n     * Removes any drawings off the canvas.\n     */\n    __clearCanvas: function() {\n      this.__canvas.getContentElement().width = this.__canvas.getContentElement().width;\n      var ctx = this.__canvas.getContext2d();\n      ctx.clearRect(0, 0, this._to(this.__canvasSize), this._to(this.__canvasSize));\n      ctx.fillStyle = \"#ffffff\";\n      ctx.fillRect(0, 0, this._to(this.__canvasSize), this._to(this.__canvasSize));\n      ctx.fill();\n    },\n\n\n    /**\n     * Handles the <code>trackstart</code>  event on canvas.\n     */\n    _onTrackStart : function(evt) {\n      this.__canvasLeft = qx.bom.element.Location.getLeft(this.__canvas.getContentElement(), \"padding\");\n      this.__canvasTop = qx.bom.element.Location.getTop(this.__canvas.getContentElement(), \"padding\");\n\n      this.__draw(evt);\n    },\n\n\n    /**\n     * Handles the <code>track</code>  event on canvas.\n     */\n    _onTrack : function(evt) {\n      this.__draw(evt);\n      evt.preventDefault();\n      evt.stopPropagation();\n    },\n\n\n    /**\n     * Handles the <code>trackend</code> event on canvas.\n     */\n    _onTrackEnd : function(evt) {\n      this.__lastPoint = {};\n    },\n\n\n    /**\n     * Draws the line on canvas.\n     */\n    __draw: function(evt) {\n        var ctx = this.__canvas.getContext2d();\n        var lastPoint = this.__lastPoint[evt.getPointerId()];\n\n        var pointerLeft = evt.getViewportLeft() - this.__canvasLeft;\n        var pointerTop = evt.getViewportTop() - this.__canvasTop;\n\n        var opacity = null;\n\n        if (lastPoint) {\n          ctx.beginPath();\n          ctx.lineCap = 'round';\n          ctx.moveTo(this._to(lastPoint.x), this._to(lastPoint.y));\n          ctx.lineTo(this._to(pointerLeft), this._to(pointerTop));\n\n          var deltaX = Math.abs(lastPoint.x - pointerLeft);\n          var deltaY = Math.abs(lastPoint.y - pointerTop);\n\n          var velocity = Math.sqrt(Math.pow(deltaX ,2) + Math.pow(deltaY ,2));\n\n          opacity = (100 - velocity) / 100;\n          opacity = Math.round(opacity * Math.pow(10, 2)) / Math.pow(10, 2);\n\n          if (!lastPoint.opacity) {\n            lastPoint.opacity = 1;\n          }\n          if (opacity < 0.1) {\n            opacity = 0.1;\n          }\n\n          // linear gradient from start to end of line\n          var grad = ctx.createLinearGradient(lastPoint.x, lastPoint.y, pointerLeft, pointerTop);\n          grad.addColorStop(0, 'rgba(61,114,201,' + lastPoint.opacity + ')');\n          grad.addColorStop(1, 'rgba(61,114,201,' + opacity + ')');\n          ctx.strokeStyle = grad;\n\n          ctx.lineWidth = this._to(1.5);\n\n          ctx.stroke();\n        }\n\n        this.__lastPoint[evt.getPointerId()] = {\n          \"x\": pointerLeft,\n          \"y\": pointerTop,\n          \"opacity\": opacity\n        };\n      }\n    },\n\n\n    destruct : function()\n    {\n      this._disposeObjects();\n    }\n\n});\n"
  ]
}